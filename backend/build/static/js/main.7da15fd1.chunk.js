(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{24:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);n(24);var r=n(1),a=n(23),c=n.n(a),i=n(10),s=n(3),o=n(2),u=n(8),d=n(0),l=function(e){var t=e.lists,n=e.user,a=e.setUser,c=e.setLists,i=(e.addList,Object(r.useState)("")),l=Object(s.a)(i,2),j=(l[0],l[1],Object(o.g)());return n?t?Object(d.jsxs)("div",{className:"sidepanel",children:[Object(d.jsx)("button",{onClick:function(){window.localStorage.removeItem("user"),a(null),c([]),j("/login")},children:"log out"}),Object(d.jsx)("button",{onClick:function(){return j("/")},children:"home"}),!1,t.map((function(e){return Object(d.jsx)("div",{className:"link",children:Object(d.jsx)(u.b,{to:"/".concat(e.name),children:e.name})},e.id)})),Object(d.jsx)("button",{onClick:function(){return j("/")},children:"+"})]}):Object(d.jsx)("div",{className:"sidepanel",children:"loading lists..."}):Object(d.jsx)("div",{className:"sidepanel",children:Object(d.jsx)("p",{children:"Log in to create lists"})})},j=function(e){var t=e.list,n=e.addTodo,a=e.removeTodo,c=e.removeList,i=Object(o.g)(),l=Object(r.useState)(!1),j=Object(s.a)(l,2),b=j[0],f=j[1],p=Object(r.useState)("all"),O=Object(s.a)(p,2),h=O[0],v=O[1],m=Object(r.useState)(""),x=Object(s.a)(m,2),w=x[0],g=x[1],k=Object(r.useState)(""),S=Object(s.a)(k,2),y=S[0],T=S[1],L=Object(r.useState)((new Date).toISOString().substring(0,10)),N=Object(s.a)(L,2),C=N[0],D=N[1];return t?Object(d.jsxs)("div",{className:"view",children:[Object(d.jsxs)("h4",{children:[t.name,Object(d.jsx)("button",{onClick:function(){return function(e){window.confirm("Do you want to remove ".concat(e.name,"?"))&&(i("/"),c(e.id))}(t)},children:"remove this list"})]}),b&&Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(t.id,{name:w,description:y,status:!1,deadline:C}),f(!1),g(""),T(""),D((new Date).toISOString().substring(0,10))},children:[Object(d.jsx)("div",{children:Object(d.jsx)("input",{type:"text",placeholder:"name",value:w,name:"name",onChange:function(e){var t=e.target;return g(t.value)}})}),Object(d.jsx)("div",{children:Object(d.jsx)("textarea",{placeholder:"description (optional)",value:y,name:"description",onChange:function(e){var t=e.target;return T(t.value)}})}),Object(d.jsx)("div",{children:Object(d.jsx)("input",{type:"date",value:C,name:"deadline",onChange:function(e){var t=e.target;return D(t.value)}})}),Object(d.jsx)("button",{type:"submit",children:"add"})]}),Object(d.jsx)("button",{onClick:function(){return f(!b)},children:b?"cancel":"add todo"}),!b&&Object(d.jsxs)("div",{className:"list",children:[Object(d.jsx)("button",{onClick:function(){v("all"===h?"not done":"not done"===h?"done":"all")},children:h}),t.todos.filter((function(e){return"done"===h?e.status:"not done"!==h||!e.status})).sort((function(e,t){return new Date(e.deadline).getTime()-new Date(t.deadline).getTime()})).map((function(e){return Object(d.jsxs)("div",{className:"link",children:[Object(d.jsx)(u.b,{to:"/".concat(t.name,"/").concat(e.id),children:e.name}),Object(d.jsx)("button",{name:"remove",onClick:function(){return function(e){window.confirm("Do you want to remove ".concat(e.name,"?"))&&a(t.id,e.id)}(e)},children:"remove"}),Object(d.jsxs)("p",{children:[new Date(e.deadline).toDateString()," ",e.status?"\u2714":"\u2716"]})]},e.id)}))]})]}):Object(d.jsx)("div",{className:"view",children:"loading list..."})},b=function(e){var t=e.todo,n=e.editTodo,r=Object(o.h)();return t?Object(d.jsxs)("div",{className:"view",children:[Object(d.jsx)("div",{className:"link",children:Object(d.jsx)(u.b,{to:"/".concat(r.list),children:"< ".concat(r.list)})}),Object(d.jsx)("h4",{children:t.name}),Object(d.jsx)("div",{children:t.description}),Object(d.jsx)("div",{children:new Date(t.deadline).toDateString()}),Object(d.jsxs)("div",{children:["done ",Object(d.jsx)("input",{type:"checkbox",defaultChecked:t.status,onChange:function(){return function(){var e={status:!t.status};n(t.id,e)}()}})]})]}):Object(d.jsx)("div",{className:"view",children:"loading todo..."})},f=function(e){var t=e.addList,n=Object(r.useState)(""),a=Object(s.a)(n,2),c=a[0],i=a[1];return Object(d.jsxs)("div",{className:"view",children:[Object(d.jsx)("h3",{children:"Add list"}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(c),i("")},children:[Object(d.jsxs)("div",{children:["list name",Object(d.jsx)("input",{type:"text",value:c,name:"name",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(d.jsx)("button",{type:"submit",children:"add list"})]})]})},p=n(4),O=n.n(p),h=n(7),v=n(9),m=n.n(v),x=function(){var e=Object(h.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(h.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g={login:x,signin:w},k="/api/todos",S=null,y=function(){var e=Object(h.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:S}},e.next=3,m.a.get(k,t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(h.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:S}},e.next=3,m.a.post(k,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(h.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:S}},e.next=3,m.a.delete("".concat(k,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(h.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:S}},e.next=3,m.a.post("".concat(k,"/").concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(){var e=Object(h.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:S}},e.next=3,m.a.delete("".concat(k,"/").concat(t,"/").concat(n),r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(h.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:S}},e.next=3,m.a.put("".concat(k,"/").concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A={setToken:function(e){S="bearer ".concat(e)},getTodoLists:y,addList:T,removeList:L,addTodo:N,removeTodo:C,editTodo:D},I=function(e){var t=e.setUser,n=Object(r.useState)(!1),a=Object(s.a)(n,2),c=a[0],i=a[1],u=Object(r.useState)(""),l=Object(s.a)(u,2),j=l[0],b=l[1],f=Object(r.useState)(""),p=Object(s.a)(f,2),v=p[0],m=p[1],x=Object(o.g)(),w=function(){var e=Object(h.a)(O.a.mark((function e(n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,g.login({username:j,password:v});case 4:r=e.sent,window.localStorage.setItem("user",JSON.stringify(r)),A.setToken(r.token),t(r),b(""),m(""),x("/",{replace:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),window.alert("Log in failed!");case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(O.a.mark((function e(n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,g.signin({username:j,password:v});case 4:if(!e.sent){e.next=15;break}return e.next=8,g.login({username:j,password:v});case 8:r=e.sent,window.localStorage.setItem("user",JSON.stringify(r)),A.setToken(r.token),t(r),b(""),m(""),x("/",{replace:!0});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),window.alert("Sign in failed: try another username.");case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"view",children:[Object(d.jsx)("h3",{children:c?"Sign up":"Log in"}),Object(d.jsxs)("form",{onSubmit:c?k:w,children:[Object(d.jsxs)("div",{children:["username",Object(d.jsx)("input",{type:"text",value:j,name:"username",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(d.jsxs)("div",{children:["password",Object(d.jsx)("input",{type:"password",values:v,name:"password",onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(d.jsx)("button",{type:"submit",children:c?"sign up":"log in"})]}),!c&&Object(d.jsx)("p",{children:"Create username and password"}),Object(d.jsx)("button",{onClick:function(){return i(!c)},children:c?"back":"create profile"})]})},z=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),u=Object(s.a)(c,2),p=u[0],O=u[1],h=Object(o.g)();Object(r.useEffect)((function(){n&&A.getTodoLists().then((function(e){O(e)}))}),[n]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("user");if(e){var t=JSON.parse(e);a(t),A.setToken(t.token)}else h("/login",{replace:!0})}),[]);var v=function(e){var t=p.find((function(t){return t.name===e}));if(t)window.alert("List ".concat(e," already exists!"));else{var n={name:e,todos:[]};A.addList(n).then((function(e){O(p.concat(e))})).catch((function(){window.alert("Try different name. Must be at least one character.")}))}},m=Object(o.f)("/:list"),x=Object(o.f)("/:list/:id"),w=m?p.find((function(e){return e.name===m.params.list})):[],g=x&&p&&p.length>0?p.find((function(e){return e.name===x.params.list})).todos.find((function(e){return e.id===x.params.id})):{};return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"header",children:Object(d.jsx)("h2",{children:"Todos"})}),Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)(l,{lists:p,user:n,setUser:a,setLists:O,addList:v}),Object(d.jsxs)(o.c,{children:[Object(d.jsx)(o.a,{path:"/login",element:Object(d.jsx)(I,{setUser:a})}),Object(d.jsx)(o.a,{path:"/:list/:id",element:Object(d.jsx)(b,{todo:g,editTodo:function(e,t){A.editTodo(e,t).then((function(e){var t=p.map((function(t){return t.id===e.list?Object(i.a)(Object(i.a)({},t),{},{todos:t.todos.map((function(t){return t.id===e.id?e:t}))}):t}));O(t)}))}})}),Object(d.jsx)(o.a,{path:"/:list",element:Object(d.jsx)(j,{list:w,addTodo:function(e,t){var n=new Date(t.deadline),r=Object(i.a)(Object(i.a)({},t),{},{deadline:n});A.addTodo(e,r).then((function(t){var n=p.map((function(n){return n.id===e?Object(i.a)(Object(i.a)({},n),{},{todos:n.todos.concat(t)}):n}));O(n)})).catch((function(){window.alert("Todo must contain name and deadline in correct format.")}))},removeTodo:function(e,t){A.removeTodo(e,t).then((function(){var n=p.map((function(n){return n.id===e?Object(i.a)(Object(i.a)({},n),{},{todos:n.todos.filter((function(e){return e.id!==t}))}):n}));O(n)}))},removeList:function(e){A.removeList(e).then((function(){O(p.filter((function(t){return t.id!==e})))}))}})}),Object(d.jsx)(o.a,{path:"/",element:Object(d.jsx)(f,{addList:v})})]})]})]})};c.a.render(Object(d.jsx)(u.a,{children:Object(d.jsx)(z,{})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.7da15fd1.chunk.js.map